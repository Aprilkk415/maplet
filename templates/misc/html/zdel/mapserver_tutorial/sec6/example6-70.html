<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <style type="text/css">
        ##mapdiv {
            width: 800px;
            height: 475px;
            border: 1px solid black;
        }
    </style>
    <script src="http://openlayers.org/api/OpenLayers.js"></script>

    <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>


    <script type="text/javascript">
        //Google has 20 scales
        //Resolutions always start big to small, descending order
        //numZoomLevels=20 (corresponds to Googles 20 zoom levels)
        //map.setCenter(center, 19); (Zoom Level starts at 0 and ends in 19)


        var navigation_control = new OpenLayers.Control.Navigation({});
        var controls_array = [
            navigation_control,
            new OpenLayers.Control.PanZoomBar({}),
            new OpenLayers.Control.LayerSwitcher({}),
            new OpenLayers.Control.Permalink(),
            new OpenLayers.Control.Graticule({interval: [10, 5, 3, 2], targetSize: 500}),
            new OpenLayers.Control.MousePosition({})
        ];

        var markers = new OpenLayers.Layer.Markers("Markers");

        window.onload = function () {

            /*
             map = new OpenLayers.Map('mapdiv', {controls: controls_array},
             {
             maxExtent: new OpenLayers.Bounds(//设置地图域
             -128 * 156543.0339,
             -128 * 156543.0339,
             128 * 156543.0339,
             128 * 156543.0339),
             maxResolution: 156543.0339,//最大分辨率
             units: 'm',//度量单位
             projection: new OpenLayers.Projection('EPSG:900913'),//投影规则
             displayProjection: new OpenLayers.Projection("EPSG:4326") //显示的投影规则
             //maxExtent: new OpenLayers.Bounds(-20037508.34, -20037508.34, 20037508.34, 20037508.34)
             });
             */

            map = new OpenLayers.Map('mapdiv', {
                controls: controls_array
            }, {
                projection: new OpenLayers.Projection('EPSG:900913'),
                displayProjection: new OpenLayers.Projection('EPSG:4326'),
                maxExtent: new OpenLayers.Bounds(-20037508.34, -20037508.34, 20037508.34, 20037508.34)
            });


//            map.addLayer(markers);//地图初始化添加

            var serverURL = "/cgi-bin/mapserv";


            var gmap = new OpenLayers.Layer.Google(
                    "Google Streets", // the default
                    {numZoomLevels: 20},
                    {isBaseLayer: false}
                    // default type, no change needed here
            );

            /*
             var layer_obj3 = new OpenLayers.Layer.WMS(
             "EX2f",
             serverURL,

             {
             // projection: new OpenLayers.Projection("EPSG:4326"),
             //sphericalMercator: true,
             layers: 'bou',
             map: '/home/bk/ws/nedata/demo.map'

             //srs: 'EPSG:900913'
             },
             {singleTile: true, ratio: 1, isBaseLayer: false, opacity: 0.8, visibility: true,
             projection: new OpenLayers.Projection("EPSG:3857")}
             );
             */


            var layer_obj3 = new OpenLayers.Layer.WMS('NOAA RidgeRadar',
                    serverURL,
                    {
                        layers: 'bou',
                        map: '/opt/webgis/data/demo.map',
                        transparent: true,
                        singleTile: true,
                        visibility: true,
                        // projection: new OpenLayers.Projection("EPSG:4326")
                        srs: 'EPSG:900913'
                    });


            // layer_obj3.setIsBaseLayer(false);
            // map.addLayers([layer_obj, layer_obj2, google_streets]);
            map.addLayer(gmap);
            map.addLayer(layer_obj3);

            map.addControl(new OpenLayers.Control.ScaleLine());

            //var center = new OpenLayers.LonLat(124, 46);
            // map.setCenter(center, 10);

            // map.zoomToExtent(layer_obj3.getDataExtent());
            // map.zoomToMaxExtent();

            var newCenter = new OpenLayers.LonLat(110, 40);
            newCenter.transform(new OpenLayers.Projection('EPSG:4326'), map.getProjectionObject());
            map.setCenter(newCenter)
        }

    </script>
</head>
<body>
<div>查看</div>
<div><a href="http://192.168.4.111/cgi-bin/mapserv?map=/opt/webgis/data/demo.map&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&SRS=EPSG:4326&LAYERS=bou&BBOX=80,20,130,50&FORMAT=png&width=400&height=300">打开</a></div>
<div id="mapdiv"></div>
</body>
</html>
